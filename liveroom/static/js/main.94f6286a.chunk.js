(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(20)},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(2),i=n(4),r=n(3),c=n(5),d=n(0),l=n.n(d),s=n(11),u=n.n(s),w=n(6),p=n.n(w),m=n(7);var v=Object(m.a)({ChatViewState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"newState"===t.type&&(e=t.newState),"AddNewStateMessage"===t.type?(e.push(t.Message),e):e},NewComponent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"newComponent"===t.type?e=t.newComponent:e},SetName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknow",t=arguments.length>1?arguments[1]:void 0;return"setName"===t.type?e=t.name:e},SetSessionID:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"setSessionID"===t.type?e=t.ID:e},peer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"newPeer"===t.type?e=t.peer:e},LiveVideoObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"newVideoObject"===t.type?e=t.newVideoObject:e},AppState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"state"===t.type?(e[t.tag]=t.tagValue,e):e}}),g=Object(m.b)(v,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),f=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(c)))).NewComponentstate=function(){n.setState({})},n.autoscroll=!1,n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){console.log("Hello world!"),g.dispatch({type:"newComponent",newComponent:this.NewComponentstate})}},{key:"componentWillUpdate",value:function(){var e=document.querySelector(".rootscroll"),t=e.scrollHeight-e.clientHeight,n=e.scrollTop;this.autoscroll=n===t}},{key:"componentDidUpdate",value:function(){var e=document.querySelector(".rootscroll");!0===this.autoscroll&&(e.scrollTop=e.scrollHeight)}},{key:"render",value:function(){return l.a.createElement("div",null,g.getState().ChatViewState.map(function(e){var t=e;return l.a.createElement("div",{key:1e7*Math.random()},l.a.createElement("p",{className:"text-view"},"object"===typeof t?l.a.createElement("span",{className:"text-primary"},"Unkown "):l.a.createElement("span",{className:"text-warning"},"Unkown "),"object"===typeof t?t[0]:t))}))}}]),t}(d.Component),h=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(c)))).typing=function(e){g.getState().peer.send("Order->WriteState->[".concat(e,"]"))},n.sender=function(e){var t=e.key,o=e.target.value;if(e.persist(),"Enter"===t){if(g.getState().peer.send("Order->WriteState->[false]"),0==o.length)return;g.dispatch({type:"AddNewStateMessage",Message:o}),g.getState().peer.send(o),g.getState().NewComponent(),e.target.value=""}else n.typing(!0)},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"w-100 h-100"},l.a.createElement("input",{className:"input-sender",disabled:!0,onFocus:function(){return e.typing(!0)},onBlur:function(){return e.typing(!1)},onKeyPress:this.sender}))}}]),t}(d.Component),S=(n(19),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(c)))).reloadApp=function(){n.setState({})},n.componentWillMount=function(){g.dispatch({type:"state",tag:"writing",tagValue:!1}),g.dispatch({type:"state",tag:"writingComponent",tagValue:n.reloadApp})},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:!0===g.getState().AppState.writing?"writingAnimationIn":"writingAnimationOut"},l.a.createElement("label",{style:{fontSize:18,color:"#00C851"}},"Writing.."))}}]),t}(d.Component)),y=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(c)))).state={videoState:!0,audioState:!0},n.reloadState=function(){n.setState({})},n.muteonoff=function(){n.setState({otherLiveMute:!n.state.otherLiveMute})},n.componentDidMount=function(){g.dispatch({type:"state",tag:"livevadeo",tagValue:n.reloadState}),g.dispatch({type:"state",tag:"muteonoff",tagValue:n.muteonoff})},n.audioSwitch=function(){!0===n.state.audioState?g.getState().peer.send("audio->state->[off]"):g.getState().peer.send("audio->state->[on]"),n.setState({audioState:!0!==n.state.audioState})},n.videoSwitch=function(){!0===n.state.videoState?(g.getState().peer.send("video->state->[off]"),document.querySelector("#liveVideo-you").pause()):(document.querySelector("#liveVideo-you").load(),g.getState().peer.send("video->state->[on]")),n.setState({videoState:!0!==n.state.videoState})},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"liveSection"},l.a.createElement("div",{className:"V"},l.a.createElement("video",{autoPlay:!0,muted:this.state.otherLiveMute,id:"liveVideo"})),l.a.createElement("div",{className:"V"},l.a.createElement("video",{autoPlay:!0,muted:!0,id:"liveVideo-you"})),l.a.createElement("div",{className:"tools"},l.a.createElement("button",{onClick:this.videoSwitch},!0===this.state.videoState?l.a.createElement("i",{class:"material-icons "},"videocam"):l.a.createElement("i",{class:"material-icons "},"videocam_off")),l.a.createElement("button",{onClick:this.audioSwitch},!0===this.state.audioState?l.a.createElement("i",{class:"material-icons "},"volume_up"):l.a.createElement("i",{class:"material-icons "},"volume_off"))))}}]),t}(d.Component),b={to:function(e){return"video->state->[off]"===e?(document.querySelector("#liveVideo").style.display="none",this):"video->state->[on]"===e?(document.querySelector("#liveVideo").style.display="inline-block",this):"Order->WriteState->[true]"===e?(g.dispatch({type:"state",tag:"writing",tagValue:!0}),g.getState().AppState.writingComponent(),this):"Order->WriteState->[false]"===e?(g.dispatch({type:"state",tag:"writing",tagValue:!1}),g.getState().AppState.writingComponent(),this):"audio->state->[off]"==e?(g.getState().AppState.muteonoff(),this):"audio->state->[on]"==e?(g.getState().AppState.muteonoff(),this):(g.dispatch({type:"AddNewStateMessage",Message:[e]}),g.getState().NewComponent(),this)}},E=function(e,t){window.speer_=new Peer,window.tpeer_=new Peer,window.speer_c=window.speer_.connect(e),window.tpeer_c=window.tpeer_.connect(t),window.speer_c.on("open",function(){window.speer_c.send("hi! speer_c")}),window.tpeer_c.on("open",function(){window.tpeer_c.send("hi! tpeer_c")});var n=(window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia).bind(navigator);n({video:!0,audio:!1},function(t){console.log("here 1"),window.speer_.call(e,t).on("stream",function(e){console.log("s",e),document.querySelector("#liveVideo").srcObject=e})},function(e){console.log("Failed to get local stream",e)}),n({video:!0,audio:!1},function(e){console.log("here 2"),window.tpeer_.call(t,e).on("stream",function(e){console.log("t",e),document.querySelector("#liveVideo-you").srcObject=e})},function(e){console.log("Failed to get local stream",e)})},O=function(e){window.adminSendPeerLoop=setInterval(function(){1==window.adminSendPeer.open&&(p.a.ajax({url:"../ajax/meet.php",type:"post",data:{req:"add_peer_ids_to_meet",type_:e,idmeet:window.$_GET.idmeet,peerid:window.adminSendPeer.id},success:function(e){console.log(e)}}),clearInterval(window.adminSendPeerLoop))})};(function(){window.adminSendPeer=new Peer,window.adminSendPeer.on("open",function(){window.adminSendPeer.on("connection",function(e){e.on("data",function(e){console.log(e)});var t=(window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia).bind(navigator);e.on("call",function(e){t({video:!0,audio:!0},function(t){console.log("Calling you"),e.answer(t)},function(e){console.log("Failed to get local stream",e)})})})})})(),window.peer=new Peer;var j=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){if(window.$_GET.roomId||void 0!=window.$_GET.adminAccess)if(void 0!=window.$_GET.adminAccess)p.a.ajax({url:"../ajax/meet.php",type:"post",data:{req:"isAdmin"},success:function(e){1==e.includes("true")?(console.log("admin",e),E(window.$_GET.speer,window.$_GET.tpeer)):console.log("No admin",e)}});else{var e=window.peer.connect(window.$_GET.roomId);g.dispatch({type:"newPeer",peer:e}),O("student"),(window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia).bind(navigator)({video:!0,audio:!0},function(e){window.peer.call(window.$_GET.roomId,e).on("stream",function(t){window.remoteStream_=t,document.querySelector("#liveVideo").srcObject=t,document.querySelector("#liveVideo-you").srcObject=e,g.dispatch({type:"newVideoObject",newVideoObject:t}),g.getState().AppState.livevadeo()})},function(e){console.log("Failed to get local stream",e)}),e.on("open",function(){document.querySelector(".input-sender").disabled=!1,window.peer.on("connection",function(e){e.send("hi!")}),e.on("data",function(e){b.to(e)})})}else window.createRoomId=setInterval(function(){!0===window.peer.open&&(p.a.ajax({url:"../ajax/meet.php",type:"post",data:{req:"addRoomLive",idmeet:window.$_GET.idmeet,idRoom:window.peer.id,student:window.$_GET.student},success:function(e){console.log(e)}}),O("teacher"),clearInterval(window.createRoomId))},1e4),window.peer.on("connection",function(e){document.querySelector(".input-sender").disabled=!1,g.dispatch({type:"newPeer",peer:e});var t=(window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia).bind(navigator);window.peer.on("call",function(e){t({video:!0,audio:!0},function(t){e.answer(t),e.on("stream",function(e){window.remoteStream_=e,document.querySelector("#liveVideo").srcObject=e,document.querySelector("#liveVideo-you").srcObject=t,g.dispatch({type:"newVideoObject",newVideoObject:e}),g.getState().AppState.livevadeo()})},function(e){console.log("Failed to get local stream",e)})}),e.on("data",function(e){b.to(e)})})}},{key:"componentWillMount",value:function(){var e=window.location.search.substr(1).split("&");window.$_GET={};for(var t=0;t<e.length;t++){var n=e[t].split("=");window.$_GET[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}}},{key:"render",value:function(){return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12 col-xl-3"},l.a.createElement(y,null)),l.a.createElement("div",{className:"col  col-sm-9",style:{height:"100vh"}},l.a.createElement("div",{className:"col  col-sm-12",style:{height:"5%"}},l.a.createElement(S,null)),l.a.createElement("div",{className:"col  col-sm-12 rootscroll",style:{height:"85vh",overflowY:"scroll"}},l.a.createElement(f,null)),l.a.createElement("div",{className:"col  col-sm-12",style:{height:"10%"}},l.a.createElement(h,null))))}}]),t}(d.Component);u.a.render(l.a.createElement(j,null),p()("#root")[0])}},[[13,1,2]]]);
//# sourceMappingURL=main.94f6286a.chunk.js.map